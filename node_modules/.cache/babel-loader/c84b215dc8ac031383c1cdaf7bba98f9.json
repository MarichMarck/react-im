{"ast":null,"code":"import\"antd/lib/skeleton/style\";import _Skeleton from\"antd/lib/skeleton\";import\"antd/lib/row/style\";import _Row from\"antd/lib/row\";import\"antd/lib/col/style\";import _Col from\"antd/lib/col\";import\"antd/lib/avatar/style\";import _Avatar from\"antd/lib/avatar\";import _classCallCheck from\"/Users/mr.bo/\\u9879\\u76EE/React/react-im\\u7684\\u526F\\u672C/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/mr.bo/\\u9879\\u76EE/React/react-im\\u7684\\u526F\\u672C/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/mr.bo/\\u9879\\u76EE/React/react-im\\u7684\\u526F\\u672C/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/mr.bo/\\u9879\\u76EE/React/react-im\\u7684\\u526F\\u672C/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/mr.bo/\\u9879\\u76EE/React/react-im\\u7684\\u526F\\u672C/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{connect}from'react-redux';var Message=/*#__PURE__*/function(_Component){_inherits(Message,_Component);function Message(){var _getPrototypeOf2;var _this;_classCallCheck(this,Message);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(Message)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.scrollToBottom=function(){_this.messagesEnd.scrollIntoView({behavior:'auto'});};_this.getMessList=function(){var _this$props=_this.props,_this$props$chat=_this$props.chat,messList=_this$props$chat.messList,chatUserInfo=_this$props$chat.chatUserInfo,userInfo=_this$props.user.userInfo;messList=messList[\"\".concat(userInfo.id).concat(chatUserInfo.id)];if(!messList)return null;return messList.map(function(item,index){if(item.position===\"left\"){return React.createElement(\"div\",{key:index,className:\"message-item message-left\"},React.createElement(_Row,null,React.createElement(_Col,{span:1,style:{minWidth:\"44px\"}},React.createElement(_Avatar,{shape:\"square\",src:item.avatar})),React.createElement(_Col,{span:20},React.createElement(\"div\",{className:\"message\"},React.createElement(\"span\",null,item.message)))));}else{return React.createElement(\"div\",{key:index,className:\"message-item message-right\"},React.createElement(\"div\",{className:\"pull-left message\"},React.createElement(\"span\",null,item.message)),React.createElement(\"div\",{className:\"pull-right\"},React.createElement(_Avatar,{shape:\"square\",src:item.avatar})),React.createElement(\"div\",{style:{clear:\"both\"}}));}});};return _this;}_createClass(Message,[{key:\"componentDidUpdate\",value:function componentDidUpdate(){this.scrollToBottom();}},{key:\"componentDidMount\",value:function componentDidMount(){this.scrollToBottom();}},{key:\"render\",value:function render(){var _this2=this;var loading=this.props.chat.loading;return React.createElement(\"div\",null,React.createElement(_Skeleton,{loading:loading,avatar:{shape:\"square\"},active:true,paragraph:{rows:6}},this.getMessList()),React.createElement(\"div\",{ref:function ref(el){return _this2.messagesEnd=el;}}));}// 获取消息列表的 dom 结构\n}]);return Message;}(Component);export default connect(function(state){return{chat:state.chat,user:state.user};},{})(Message);","map":{"version":3,"sources":["/Users/mr.bo/项目/React/react-im的副本/src/containers/chat/message/message.jsx"],"names":["React","Component","connect","Message","scrollToBottom","messagesEnd","scrollIntoView","behavior","getMessList","props","chat","messList","chatUserInfo","userInfo","user","id","map","item","index","position","minWidth","avatar","message","clear","loading","shape","rows","el","state"],"mappings":"+8BAAA,MAAOA,CAAAA,KAAP,EAAeC,SAAf,KAA+B,OAA/B,CACA,OAAQC,OAAR,KAAsB,aAAtB,C,GAGMC,CAAAA,O,mYAUFC,c,CAAiB,UAAM,CACnB,MAAKC,WAAL,CAAiBC,cAAjB,CAAgC,CAACC,QAAQ,CAAE,MAAX,CAAhC,EACH,C,OAeDC,W,CAAc,UAAM,iBACyC,MAAKC,KAD9C,8BACXC,IADW,CACJC,QADI,kBACJA,QADI,CACMC,YADN,kBACMA,YADN,CAC4BC,QAD5B,aACqBC,IADrB,CAC4BD,QAD5B,CAEhBF,QAAQ,CAAGA,QAAQ,WAAIE,QAAQ,CAACE,EAAb,SAAkBH,YAAY,CAACG,EAA/B,EAAnB,CACA,GAAG,CAACJ,QAAJ,CAAc,MAAO,KAAP,CACd,MAAOA,CAAAA,QAAQ,CAACK,GAAT,CAAa,SAACC,IAAD,CAAOC,KAAP,CAAiB,CACjC,GAAID,IAAI,CAACE,QAAL,GAAkB,MAAtB,CAA8B,CAC1B,MAAO,4BAAK,GAAG,CAAED,KAAV,CAAiB,SAAS,CAAC,2BAA3B,EACH,8BACI,0BAAK,IAAI,CAAE,CAAX,CAAc,KAAK,CAAE,CAACE,QAAQ,CAAE,MAAX,CAArB,EACI,6BAAQ,KAAK,CAAC,QAAd,CAAuB,GAAG,CAAEH,IAAI,CAACI,MAAjC,EADJ,CADJ,CAII,0BAAK,IAAI,CAAE,EAAX,EACI,2BAAK,SAAS,CAAC,SAAf,EACI,gCAAOJ,IAAI,CAACK,OAAZ,CADJ,CADJ,CAJJ,CADG,CAAP,CAYH,CAbD,IAaO,CACH,MAAO,4BAAK,GAAG,CAAEJ,KAAV,CAAiB,SAAS,CAAC,4BAA3B,EACH,2BAAK,SAAS,CAAC,mBAAf,EACI,gCAAOD,IAAI,CAACK,OAAZ,CADJ,CADG,CAIH,2BAAK,SAAS,CAAC,YAAf,EACI,6BAAQ,KAAK,CAAC,QAAd,CAAuB,GAAG,CAAEL,IAAI,CAACI,MAAjC,EADJ,CAJG,CAOH,2BAAK,KAAK,CAAE,CAACE,KAAK,CAAE,MAAR,CAAZ,EAPG,CAAP,CASH,CACJ,CAzBM,CAAP,CA0BH,C,kGAvDoB,CACjB,KAAKnB,cAAL,GACH,C,6DAEmB,CAChB,KAAKA,cAAL,GACH,C,uCAMQ,oBACSoB,CAAAA,OADT,CACqB,KAAKf,KAD1B,CACEC,IADF,CACSc,OADT,CAEL,MACI,gCACI,+BAAU,OAAO,CAAEA,OAAnB,CAA4B,MAAM,CAAE,CAACC,KAAK,CAAE,QAAR,CAApC,CAAuD,MAAM,KAA7D,CAA8D,SAAS,CAAE,CAACC,IAAI,CAAE,CAAP,CAAzE,EACK,KAAKlB,WAAL,EADL,CADJ,CAII,2BAAK,GAAG,CAAE,aAAAmB,EAAE,QAAI,CAAA,MAAI,CAACtB,WAAL,CAAmBsB,EAAvB,EAAZ,EAJJ,CADJ,CAQH,CAED;qBA1BkB1B,S,EA4DtB,cAAeC,CAAAA,OAAO,CAClB,SAAA0B,KAAK,QAAK,CAAClB,IAAI,CAAEkB,KAAK,CAAClB,IAAb,CAAmBI,IAAI,CAAEc,KAAK,CAACd,IAA/B,CAAL,EADa,CAC+B,EAD/B,CAAP,CAEbX,OAFa,CAAf","sourcesContent":["import React, {Component} from 'react'\nimport {connect} from 'react-redux'\nimport {Avatar, Row, Col, Skeleton} from 'antd'\n\nclass Message extends Component {\n\n    componentDidUpdate() {\n        this.scrollToBottom()\n    }\n\n    componentDidMount() {\n        this.scrollToBottom()\n    }\n\n    scrollToBottom = () => {\n        this.messagesEnd.scrollIntoView({behavior: 'auto'});\n    }\n\n    render() {\n        const {chat: {loading}} = this.props\n        return (\n            <div>\n                <Skeleton loading={loading} avatar={{shape: \"square\"}} active paragraph={{rows: 6}}>\n                    {this.getMessList()}\n                </Skeleton>\n                <div ref={el => this.messagesEnd = el}/>\n            </div>\n        )\n    }\n\n    // 获取消息列表的 dom 结构\n    getMessList = () => {\n        let {chat: {messList, chatUserInfo}, user: {userInfo}} = this.props\n        messList = messList[`${userInfo.id}${chatUserInfo.id}`]\n        if(!messList) return null\n        return messList.map((item, index) => {\n            if (item.position === \"left\") {\n                return <div key={index} className=\"message-item message-left\">\n                    <Row>\n                        <Col span={1} style={{minWidth: \"44px\"}}>\n                            <Avatar shape=\"square\" src={item.avatar}/>\n                        </Col>\n                        <Col span={20}>\n                            <div className=\"message\">\n                                <span>{item.message}</span>\n                            </div>\n                        </Col>\n                    </Row>\n                </div>\n            } else {\n                return <div key={index} className=\"message-item message-right\">\n                    <div className=\"pull-left message\">\n                        <span>{item.message}</span>\n                    </div>\n                    <div className=\"pull-right\">\n                        <Avatar shape=\"square\" src={item.avatar}/>\n                    </div>\n                    <div style={{clear: \"both\"}}/>\n                </div>\n            }\n        })\n    }\n}\n\nexport default connect(\n    state => ({chat: state.chat, user: state.user}), {}\n)(Message)"]},"metadata":{},"sourceType":"module"}