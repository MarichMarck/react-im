{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mr.bo/\\u9879\\u76EE/React/react-im/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mr.bo/\\u9879\\u76EE/React/react-im/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";/**\n * 对应 reducers 中的 action 同步/异步请求\n */import Cookies from'js-cookie';import{websocket}from'../utils/websocket';import{initChatData,receiveChatMsg,showRightType,showFriendInfo,authSuccess,errMsg,userInfo,logOut,modifyUserContacts,getNewFriends,getMailList}from'./init';import{reqLogin,reqUserInfo,reqLogout,reqUserChatDataInit,reqNewFriendList,reqUserMailList}from'../api';import{pySegSort}from'../utils';// 用户登录\nexport var login=function login(username,password){return(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var response,result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return reqLogin({username:username,password:password});case 2:response=_context.sent;result=response.data;if(result.code===200){Cookies.set('token',result.data.token);dispatch(authSuccess(result.data));}else{dispatch(errMsg(result.msg));}case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());};// 退出登录\nexport var logout=function logout(){return(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response,result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return reqLogout();case 2:response=_context2.sent;result=response.data;if(result.code===200){Cookies.remove('token');dispatch(logOut({}));}else{dispatch(errMsg(result.msg));}case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}());};// 界面信息初始化\nexport var initMain=function initMain(token){return(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var response,result,_result$data,user,contact;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return reqUserChatDataInit(token);case 2:response=_context3.sent;result=response.data;if(result.code===200){// 返回值得到的是 用户信息以及历史会话\n_result$data=result.data,user=_result$data.user,contact=_result$data.contact;dispatch(userInfo({userInfo:user,contacts:contact}));websocket(user);}else{dispatch(errMsg(result.msg));}case 5:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}());};// 获取用户信息\nexport var initUserInfo=function initUserInfo(token){return(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var response,result;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return reqUserInfo(token);case 2:response=_context4.sent;result=response.data;if(result.code===200){dispatch(userInfo(result.data));websocket(result.data.userInfo);}else{dispatch(errMsg(result.msg));}case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}());};// 修改消息会话列表\nexport var modifyContacts=function modifyContacts(contacts){return function(dispatch){dispatch(modifyUserContacts({contacts:contacts}));};};// 初始化消息列表\nexport var initChatInfo=function initChatInfo(chatUserInfo){return function(dispatch){var messList=chatUserInfo.uid===1?[{id:1,avatar:\"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1582778785114&di=4bf0a9cbe00cd200465af9fe46b3091e&imgtype=0&src=http%3A%2F%2Fwww.56ec.org.cn%2Fd%2Ffile%2Fnews%2Frwgd%2F2017-05-15%2Fa26c40ec7d83c66d78ad6f791952a01b.jpg\",message:\" 我这辈子最后悔的事情，就是创建阿里巴巴，我不喜欢钱，我对钱没有兴趣\",position:\"left\"},{id:2,avatar:\"http://t8.baidu.com/it/u=3571592872,3353494284&fm=79&app=86&size=h300&n=0&g=4n&f=jpeg?sec=1583315718&t=9caf2bcbcf5ea34c543c426750bb1134\",message:\"嗯，我也是\",position:\"right\"},{id:3,avatar:\"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1582778785114&di=4bf0a9cbe00cd200465af9fe46b3091e&imgtype=0&src=http%3A%2F%2Fwww.56ec.org.cn%2Fd%2Ffile%2Fnews%2Frwgd%2F2017-05-15%2Fa26c40ec7d83c66d78ad6f791952a01b.jpg\",message:\" 我这辈子最后悔的事情，就是创建阿里巴巴，我不喜欢钱，我对钱没有兴趣\",position:\"left\"},{id:4,avatar:\"http://t8.baidu.com/it/u=3571592872,3353494284&fm=79&app=86&size=h300&n=0&g=4n&f=jpeg?sec=1583315718&t=9caf2bcbcf5ea34c543c426750bb1134\",message:\"嗯，我也是\",position:\"right\"},{id:5,avatar:\"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1582778785114&di=4bf0a9cbe00cd200465af9fe46b3091e&imgtype=0&src=http%3A%2F%2Fwww.56ec.org.cn%2Fd%2Ffile%2Fnews%2Frwgd%2F2017-05-15%2Fa26c40ec7d83c66d78ad6f791952a01b.jpg\",message:\" 我这辈子最后悔的事情，就是创建阿里巴巴，我不喜欢钱，我对钱没有兴趣\",position:\"left\"},{id:6,avatar:\"http://t8.baidu.com/it/u=3571592872,3353494284&fm=79&app=86&size=h300&n=0&g=4n&f=jpeg?sec=1583315718&t=9caf2bcbcf5ea34c543c426750bb1134\",message:\"嗯，我也是\",position:\"right\"},{id:7,avatar:\"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1582778785114&di=4bf0a9cbe00cd200465af9fe46b3091e&imgtype=0&src=http%3A%2F%2Fwww.56ec.org.cn%2Fd%2Ffile%2Fnews%2Frwgd%2F2017-05-15%2Fa26c40ec7d83c66d78ad6f791952a01b.jpg\",message:\" 我这辈子最后悔的事情，就是创建阿里巴巴，我不喜欢钱，我对钱没有兴趣\",position:\"left\"},{id:8,avatar:\"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1582778785114&di=4bf0a9cbe00cd200465af9fe46b3091e&imgtype=0&src=http%3A%2F%2Fwww.56ec.org.cn%2Fd%2Ffile%2Fnews%2Frwgd%2F2017-05-15%2Fa26c40ec7d83c66d78ad6f791952a01b.jpg\",message:\" 我这辈子最后悔的事情，就是创建阿里巴巴，我不喜欢钱，我对钱没有兴趣\",position:\"left\"},{id:9,avatar:\"http://t8.baidu.com/it/u=3571592872,3353494284&fm=79&app=86&size=h300&n=0&g=4n&f=jpeg?sec=1583315718&t=9caf2bcbcf5ea34c543c426750bb1134\",message:\"嗯，我也是\",position:\"right\"},{id:10,avatar:\"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1582778785114&di=4bf0a9cbe00cd200465af9fe46b3091e&imgtype=0&src=http%3A%2F%2Fwww.56ec.org.cn%2Fd%2Ffile%2Fnews%2Frwgd%2F2017-05-15%2Fa26c40ec7d83c66d78ad6f791952a01b.jpg\",message:\" 我这辈子最后悔的事情，就是创建阿里巴巴，我不喜欢钱，我对钱没有兴趣\",position:\"left\"},{id:11,avatar:\"http://t8.baidu.com/it/u=3571592872,3353494284&fm=79&app=86&size=h300&n=0&g=4n&f=jpeg?sec=1583315718&t=9caf2bcbcf5ea34c543c426750bb1134\",message:\"嗯，我也是\",position:\"right\"},{id:12,avatar:\"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1582778785114&di=4bf0a9cbe00cd200465af9fe46b3091e&imgtype=0&src=http%3A%2F%2Fwww.56ec.org.cn%2Fd%2Ffile%2Fnews%2Frwgd%2F2017-05-15%2Fa26c40ec7d83c66d78ad6f791952a01b.jpg\",message:\" 我这辈子最后悔的事情，就是创建阿里巴巴，我不喜欢钱，我对钱没有兴趣\",position:\"left\"},{id:13,avatar:\"http://t8.baidu.com/it/u=3571592872,3353494284&fm=79&app=86&size=h300&n=0&g=4n&f=jpeg?sec=1583315718&t=9caf2bcbcf5ea34c543c426750bb1134\",message:\"好了好了，别说了\",position:\"right\"}]:[];dispatch(initChatData({chatUserInfo:chatUserInfo,messList:messList,loading:false,showRightType:'message'}));};};// 切换右侧显示状态\nexport var changeRightType=function changeRightType(type){return function(dispatch){dispatch(showRightType({showRightType:type}));};};// 发送消息\nexport var sendChatMsg=function sendChatMsg(chat){return function(dispatch){dispatch(receiveChatMsg(chat));};};// 获取好友基本信息\nexport var getFriendInfo=function getFriendInfo(friend_uid){return(/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:dispatch(changeRightType('userInfo'));_context5.next=3;return dispatch(showFriendInfo(friend_uid));case 3:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x5){return _ref5.apply(this,arguments);};}());};// 获取好友申请列表\nexport var getNewFriendList=function getNewFriendList(token){return(/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(dispatch){var response,result;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return reqNewFriendList({token:token});case 2:response=_context6.sent;result=response.data;if(result.code===200){dispatch(getNewFriends(result.data.list));}case 5:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x6){return _ref6.apply(this,arguments);};}());};// 获取用户通讯录列表\nexport var getUserMailList=function getUserMailList(token){return(/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(dispatch){var response,result,mailList;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return reqUserMailList({token:token});case 2:response=_context7.sent;result=response.data;if(result.code===200){mailList=pySegSort(result.data.list);dispatch(getMailList(mailList));}case 5:case\"end\":return _context7.stop();}}},_callee7);}));return function(_x7){return _ref7.apply(this,arguments);};}());};","map":{"version":3,"sources":["/Users/mr.bo/项目/React/react-im/src/redux/actions.js"],"names":["Cookies","websocket","initChatData","receiveChatMsg","showRightType","showFriendInfo","authSuccess","errMsg","userInfo","logOut","modifyUserContacts","getNewFriends","getMailList","reqLogin","reqUserInfo","reqLogout","reqUserChatDataInit","reqNewFriendList","reqUserMailList","pySegSort","login","username","password","dispatch","response","result","data","code","set","token","msg","logout","remove","initMain","user","contact","contacts","initUserInfo","modifyContacts","initChatInfo","chatUserInfo","messList","uid","id","avatar","message","position","loading","changeRightType","type","sendChatMsg","chat","getFriendInfo","friend_uid","getNewFriendList","list","getUserMailList","mailList"],"mappings":"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","sourcesContent":["/**\n * 对应 reducers 中的 action 同步/异步请求\n */\nimport Cookies from 'js-cookie'\nimport {websocket} from '../utils/websocket'\nimport {\n    initChatData, receiveChatMsg, showRightType, showFriendInfo, authSuccess, errMsg, userInfo,\n    logOut, modifyUserContacts, getNewFriends, getMailList\n} from './init'\nimport {\n    reqLogin, reqUserInfo, reqLogout, reqUserChatDataInit, reqNewFriendList,\n    reqUserMailList\n} from '../api'\nimport {pySegSort} from '../utils'\n\n// 用户登录\nexport const login = (username, password) => {\n    return async dispatch => {\n        const response = await reqLogin({username, password})\n        const result = response.data\n        if (result.code === 200) {\n            Cookies.set('token', result.data.token)\n            dispatch(authSuccess(result.data))\n        } else {\n            dispatch(errMsg(result.msg))\n        }\n    }\n}\n\n// 退出登录\nexport const logout = () => {\n    return async dispatch => {\n        const response = await reqLogout()\n        const result = response.data\n        if (result.code === 200) {\n            Cookies.remove('token')\n            dispatch(logOut({}))\n        } else {\n            dispatch(errMsg(result.msg))\n        }\n    }\n}\n\n// 界面信息初始化\nexport const initMain = token => {\n    return async dispatch => {\n        const response = await reqUserChatDataInit(token)\n        const result = response.data\n        if (result.code === 200) {\n            // 返回值得到的是 用户信息以及历史会话\n            const {user, contact} = result.data\n            dispatch(userInfo({userInfo: user, contacts: contact}))\n            websocket(user)\n        } else {\n            dispatch(errMsg(result.msg))\n        }\n    }\n}\n\n// 获取用户信息\nexport const initUserInfo = token => {\n    return async dispatch => {\n        const response = await reqUserInfo(token)\n        const result = response.data\n        if (result.code === 200) {\n            dispatch(userInfo(result.data))\n            websocket(result.data.userInfo)\n        } else {\n            dispatch(errMsg(result.msg))\n        }\n    }\n}\n\n// 修改消息会话列表\nexport const modifyContacts = contacts => {\n    return dispatch => {\n        dispatch(modifyUserContacts({contacts}))\n    }\n}\n\n// 初始化消息列表\nexport const initChatInfo = chatUserInfo => {\n    return dispatch => {\n        let messList = chatUserInfo.uid === 1 ? [\n            {\n                id: 1,\n                avatar: \"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1582778785114&di=4bf0a9cbe00cd200465af9fe46b3091e&imgtype=0&src=http%3A%2F%2Fwww.56ec.org.cn%2Fd%2Ffile%2Fnews%2Frwgd%2F2017-05-15%2Fa26c40ec7d83c66d78ad6f791952a01b.jpg\",\n                message: \" 我这辈子最后悔的事情，就是创建阿里巴巴，我不喜欢钱，我对钱没有兴趣\",\n                position: \"left\"\n            },\n            {\n                id: 2,\n                avatar: \"http://t8.baidu.com/it/u=3571592872,3353494284&fm=79&app=86&size=h300&n=0&g=4n&f=jpeg?sec=1583315718&t=9caf2bcbcf5ea34c543c426750bb1134\",\n                message: \"嗯，我也是\",\n                position: \"right\"\n            },\n            {\n                id: 3,\n                avatar: \"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1582778785114&di=4bf0a9cbe00cd200465af9fe46b3091e&imgtype=0&src=http%3A%2F%2Fwww.56ec.org.cn%2Fd%2Ffile%2Fnews%2Frwgd%2F2017-05-15%2Fa26c40ec7d83c66d78ad6f791952a01b.jpg\",\n                message: \" 我这辈子最后悔的事情，就是创建阿里巴巴，我不喜欢钱，我对钱没有兴趣\",\n                position: \"left\"\n            },\n            {\n                id: 4,\n                avatar: \"http://t8.baidu.com/it/u=3571592872,3353494284&fm=79&app=86&size=h300&n=0&g=4n&f=jpeg?sec=1583315718&t=9caf2bcbcf5ea34c543c426750bb1134\",\n                message: \"嗯，我也是\",\n                position: \"right\"\n            },\n            {\n                id: 5,\n                avatar: \"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1582778785114&di=4bf0a9cbe00cd200465af9fe46b3091e&imgtype=0&src=http%3A%2F%2Fwww.56ec.org.cn%2Fd%2Ffile%2Fnews%2Frwgd%2F2017-05-15%2Fa26c40ec7d83c66d78ad6f791952a01b.jpg\",\n                message: \" 我这辈子最后悔的事情，就是创建阿里巴巴，我不喜欢钱，我对钱没有兴趣\",\n                position: \"left\"\n            },\n            {\n                id: 6,\n                avatar: \"http://t8.baidu.com/it/u=3571592872,3353494284&fm=79&app=86&size=h300&n=0&g=4n&f=jpeg?sec=1583315718&t=9caf2bcbcf5ea34c543c426750bb1134\",\n                message: \"嗯，我也是\",\n                position: \"right\"\n            },\n            {\n                id: 7,\n                avatar: \"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1582778785114&di=4bf0a9cbe00cd200465af9fe46b3091e&imgtype=0&src=http%3A%2F%2Fwww.56ec.org.cn%2Fd%2Ffile%2Fnews%2Frwgd%2F2017-05-15%2Fa26c40ec7d83c66d78ad6f791952a01b.jpg\",\n                message: \" 我这辈子最后悔的事情，就是创建阿里巴巴，我不喜欢钱，我对钱没有兴趣\",\n                position: \"left\"\n            },\n            {\n                id: 8,\n                avatar: \"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1582778785114&di=4bf0a9cbe00cd200465af9fe46b3091e&imgtype=0&src=http%3A%2F%2Fwww.56ec.org.cn%2Fd%2Ffile%2Fnews%2Frwgd%2F2017-05-15%2Fa26c40ec7d83c66d78ad6f791952a01b.jpg\",\n                message: \" 我这辈子最后悔的事情，就是创建阿里巴巴，我不喜欢钱，我对钱没有兴趣\",\n                position: \"left\"\n            },\n            {\n                id: 9,\n                avatar: \"http://t8.baidu.com/it/u=3571592872,3353494284&fm=79&app=86&size=h300&n=0&g=4n&f=jpeg?sec=1583315718&t=9caf2bcbcf5ea34c543c426750bb1134\",\n                message: \"嗯，我也是\",\n                position: \"right\"\n            },\n            {\n                id: 10,\n                avatar: \"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1582778785114&di=4bf0a9cbe00cd200465af9fe46b3091e&imgtype=0&src=http%3A%2F%2Fwww.56ec.org.cn%2Fd%2Ffile%2Fnews%2Frwgd%2F2017-05-15%2Fa26c40ec7d83c66d78ad6f791952a01b.jpg\",\n                message: \" 我这辈子最后悔的事情，就是创建阿里巴巴，我不喜欢钱，我对钱没有兴趣\",\n                position: \"left\"\n            },\n            {\n                id: 11,\n                avatar: \"http://t8.baidu.com/it/u=3571592872,3353494284&fm=79&app=86&size=h300&n=0&g=4n&f=jpeg?sec=1583315718&t=9caf2bcbcf5ea34c543c426750bb1134\",\n                message: \"嗯，我也是\",\n                position: \"right\"\n            },\n            {\n                id: 12,\n                avatar: \"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1582778785114&di=4bf0a9cbe00cd200465af9fe46b3091e&imgtype=0&src=http%3A%2F%2Fwww.56ec.org.cn%2Fd%2Ffile%2Fnews%2Frwgd%2F2017-05-15%2Fa26c40ec7d83c66d78ad6f791952a01b.jpg\",\n                message: \" 我这辈子最后悔的事情，就是创建阿里巴巴，我不喜欢钱，我对钱没有兴趣\",\n                position: \"left\"\n            },\n            {\n                id: 13,\n                avatar: \"http://t8.baidu.com/it/u=3571592872,3353494284&fm=79&app=86&size=h300&n=0&g=4n&f=jpeg?sec=1583315718&t=9caf2bcbcf5ea34c543c426750bb1134\",\n                message: \"好了好了，别说了\",\n                position: \"right\"\n            },\n        ] : []\n        dispatch(initChatData({chatUserInfo, messList, loading: false, showRightType: 'message'}))\n    }\n}\n\n// 切换右侧显示状态\nexport const changeRightType = type => {\n    return dispatch => {\n        dispatch(showRightType({showRightType: type}))\n    }\n}\n\n// 发送消息\nexport const sendChatMsg = chat => {\n    return dispatch => {\n        dispatch(receiveChatMsg(chat))\n    }\n}\n\n// 获取好友基本信息\nexport const getFriendInfo = friend_uid => {\n    return async dispatch => {\n        dispatch(changeRightType('userInfo'))\n        await dispatch(showFriendInfo(friend_uid))\n    }\n}\n\n// 获取好友申请列表\nexport const getNewFriendList = token => {\n    return async dispatch => {\n        const response = await reqNewFriendList({token})\n        const result = response.data\n        if (result.code === 200) {\n            dispatch(getNewFriends(result.data.list))\n        }\n    }\n}\n\n// 获取用户通讯录列表\nexport const getUserMailList = token => {\n    return async dispatch => {\n        const response = await reqUserMailList({token})\n        const result = response.data\n        if (result.code === 200) {\n            const mailList = pySegSort(result.data.list)\n            dispatch(getMailList(mailList))\n        }\n    }\n}"]},"metadata":{},"sourceType":"module"}