{"ast":null,"code":"import\"antd/lib/button/style\";import _Button from\"antd/lib/button\";import\"antd/lib/input/style\";import _Input from\"antd/lib/input\";import\"antd/lib/row/style\";import _Row from\"antd/lib/row\";import\"antd/lib/col/style\";import _Col from\"antd/lib/col\";import\"antd/lib/tooltip/style\";import _Tooltip from\"antd/lib/tooltip\";import\"antd/lib/icon/style\";import _Icon from\"antd/lib/icon\";import _defineProperty from\"/Users/mr.bo/\\u9879\\u76EE/React/react-im\\u7684\\u526F\\u672C/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/mr.bo/\\u9879\\u76EE/React/react-im\\u7684\\u526F\\u672C/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/mr.bo/\\u9879\\u76EE/React/react-im\\u7684\\u526F\\u672C/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/mr.bo/\\u9879\\u76EE/React/react-im\\u7684\\u526F\\u672C/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/mr.bo/\\u9879\\u76EE/React/react-im\\u7684\\u526F\\u672C/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/mr.bo/\\u9879\\u76EE/React/react-im\\u7684\\u526F\\u672C/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{connect}from'react-redux';import{pushChatMsg,recvChatMsg,modifyContacts}from'../../../redux/actions';// import { sendMsg } from '../../../utils/websocket'\nimport FaceEmjoy from'../../../components/message/face';var ChatTextarea=/*#__PURE__*/function(_Component){_inherits(ChatTextarea,_Component);function ChatTextarea(){var _getPrototypeOf2;var _this;_classCallCheck(this,ChatTextarea);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(ChatTextarea)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={message:'',showFace:false};_this.handleTextArea=function(name,e){_this.setState(_defineProperty({},name,e.target.value));};_this.showFace=function(e){e.nativeEvent.stopImmediatePropagation();var showFace=_this.state.showFace;_this.setState({showFace:!showFace});};_this.getFaceItem=function(object,faceEmjoy){var message=_this.state.message;message+=faceEmjoy+\" \";_this.setState({message:message});};_this.sendChatMess=function(e){e.preventDefault();var message=_this.state.message;if(!message)return;_this.setState({message:''});// Êé®ÈÄÅsocketÊ∂àÊÅØ\nvar chatUserInfo=_this.props.chat.chatUserInfo;// sendMsg(message, chatUserInfo.id)\n// ËøôÊòØËá™Â∑±ÁöÑÊ∂àÊÅØ\nvar _this$props$user=_this.props.user,userInfo=_this$props$user.userInfo,contacts=_this$props$user.contacts;_this.props.pushChatMsg({id:userInfo.id,to_id:chatUserInfo.id,avatar:userInfo.avatar,message:message,position:\"right\"});var randomText=[\"Â∑•ÂÖ∑‰∫∫‰∏ÄÂè∑‰∏∫ÊÇ®ÊúçÂä°ÔΩû\",\"\\u4F60\\u597D\\uFF0C\\u6211\\u662F\".concat(chatUserInfo.nickname,\"\\uFF0C\\u5F88\\u9AD8\\u5174\\u8BA4\\u8BC6\\u4F60\"),\"oh godÔºå‰Ω†Áªà‰∫éÊÉ≥Ëµ∑Êàë‰∫ÜÂïä\",\"ÊòéÂ§©‰∏ÄËµ∑ÂéªÁà¨Â±±Èú≤Ëê•ÂïäÔºåÊúâÁ©∫ÂêóÔºü\",\"helloÔºåÊàëÁé∞Âú®Âú®Â∑•‰ΩúÔºå‰Ω†Âë¢Ôºü\",\"üåπüåπ ÊÄé‰πàËØ¥Âë¢ÔºåÈÇ£Â∞±Âú®‰∏ÄËµ∑ÂêßÔΩû\"];var lastMessage=randomText[parseInt(Math.random()*randomText.length)];_this.props.recvChatMsg({id:chatUserInfo.id,to_id:userInfo.id,avatar:chatUserInfo.avatar,message:lastMessage,position:\"left\"});if(contacts){var index=contacts.findIndex(function(user){return user.id===chatUserInfo.id;});if(index>=0){contacts[index].last_mess=lastMessage;contacts[index].time=\"ÂàöÂàö\";if(index>0){contacts.unshift(contacts.splice(index)[0]);}_this.props.modifyContacts(contacts);}}};return _this;}_createClass(ChatTextarea,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;document.onclick=function(){return _this2.setState({showFace:false});};}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){document.onclick=null;// Âú®ÁªÑ‰ª∂Âç∏ËΩΩÊó∂ÔºåÂèñÊ∂à‰∫ã‰ª∂ÁõëÂê¨ÔºåÈò≤Ê≠¢ÂÜÖÂ≠òÊ≥ÑÊºè\n}},{key:\"render\",value:function render(){var _this3=this;var showFace=this.state.showFace;return React.createElement(\"section\",{style:{position:\"relative\"}},React.createElement(_Row,{className:\"chat-tools\"},React.createElement(_Col,{span:18},React.createElement(_Tooltip,{title:\"\\u53D1\\u9001\\u8868\\u60C5\"},React.createElement(_Icon,{type:\"smile\",onClick:function onClick(e){return _this3.showFace(e);}})),React.createElement(_Tooltip,{title:\"\\u53D1\\u9001\\u56FE\\u7247\"},React.createElement(_Icon,{type:\"picture\"})),React.createElement(_Tooltip,{title:\"\\u53D1\\u9001\\u4EE3\\u7801\\u7247\\u6BB5\"},React.createElement(_Icon,{type:\"code\"})),React.createElement(_Tooltip,{title:\"\\u53D1\\u9001\\u94FE\\u63A5\"},React.createElement(_Icon,{type:\"link\"})),React.createElement(FaceEmjoy,{parent:this,showFace:showFace})),React.createElement(_Col,{span:6,style:{textAlign:\"right\"}},React.createElement(_Tooltip,{title:\"\\u89C6\\u9891\\u804A\\u5929\"},React.createElement(_Icon,{type:\"video-camera\",style:{marginRight:10}})),React.createElement(_Tooltip,{title:\"\\u622A\\u56FE\"},React.createElement(_Icon,{type:\"scissor\"})))),React.createElement(_Input.TextArea,{className:\"chat-textarea\",onChange:function onChange(e){return _this3.handleTextArea('message',e);},placeholder:\"\\u8F93\\u5165\\u4FE1\\u606F...\",onPressEnter:function onPressEnter(e){return _this3.sendChatMess(e);},value:this.state.message}),React.createElement(_Button,{style:{float:\"right\"},onClick:function onClick(e){return _this3.sendChatMess(e);}},\"\\u53D1\\u9001\"));}}]);return ChatTextarea;}(Component);export default connect(function(state){return{chat:state.chat,user:state.user};},{pushChatMsg:pushChatMsg,recvChatMsg:recvChatMsg,modifyContacts:modifyContacts})(ChatTextarea);","map":{"version":3,"sources":["/Users/mr.bo/È°πÁõÆ/React/react-imÁöÑÂâØÊú¨/src/containers/chat/message/textarea.jsx"],"names":["React","Component","connect","pushChatMsg","recvChatMsg","modifyContacts","FaceEmjoy","ChatTextarea","state","message","showFace","handleTextArea","name","e","setState","target","value","nativeEvent","stopImmediatePropagation","getFaceItem","object","faceEmjoy","sendChatMess","preventDefault","chatUserInfo","props","chat","user","userInfo","contacts","id","to_id","avatar","position","randomText","nickname","lastMessage","parseInt","Math","random","length","index","findIndex","last_mess","time","unshift","splice","document","onclick","textAlign","marginRight","float"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport { Row, Col, Icon, Button, Input, Tooltip } from 'antd'\n\nimport { pushChatMsg, recvChatMsg, modifyContacts } from '../../../redux/actions'\n// import { sendMsg } from '../../../utils/websocket'\nimport FaceEmjoy from '../../../components/message/face'\n\nclass ChatTextarea extends Component {\n\n    state = { message: '', showFace: false }\n\n    componentDidMount(){\n        document.onclick = () => this.setState({ showFace: false })\n    }\n\n    componentWillUnmount() {\n        document.onclick = null // Âú®ÁªÑ‰ª∂Âç∏ËΩΩÊó∂ÔºåÂèñÊ∂à‰∫ã‰ª∂ÁõëÂê¨ÔºåÈò≤Ê≠¢ÂÜÖÂ≠òÊ≥ÑÊºè\n    }\n\n    handleTextArea = (name, e) => {\n        this.setState({ [name]: e.target.value })\n    }\n\n    render() {\n        const { showFace } = this.state\n        return (\n            <section style={{ position: \"relative\" }}>\n                <Row className=\"chat-tools\">\n                    <Col span={18}>\n                        <Tooltip title=\"ÂèëÈÄÅË°®ÊÉÖ\">\n                            <Icon type=\"smile\" onClick={e => this.showFace(e)} />\n                        </Tooltip>\n                        <Tooltip title=\"ÂèëÈÄÅÂõæÁâá\"><Icon type=\"picture\" /></Tooltip>\n                        <Tooltip title=\"ÂèëÈÄÅ‰ª£Á†ÅÁâáÊÆµ\"><Icon type=\"code\" /></Tooltip>\n                        <Tooltip title=\"ÂèëÈÄÅÈìæÊé•\"><Icon type=\"link\" /></Tooltip>\n                        <FaceEmjoy parent={ this } showFace={showFace} />\n                    </Col>\n                    <Col span={6} style={{ textAlign: \"right\" }}>\n                        <Tooltip title=\"ËßÜÈ¢ëËÅäÂ§©\"><Icon type=\"video-camera\" style={{ marginRight: 10 }} /></Tooltip>\n                        <Tooltip title=\"Êà™Âõæ\"><Icon type=\"scissor\" /></Tooltip>\n                    </Col>\n                </Row>\n                <Input.TextArea className=\"chat-textarea\"\n                       onChange={e => this.handleTextArea('message', e) } placeholder=\"ËæìÂÖ•‰ø°ÊÅØ...\"\n                       onPressEnter={e => this.sendChatMess(e) }\n                       value={this.state.message}\n                />\n                <Button style={{ float: \"right\" }} onClick={ e => this.sendChatMess(e) }>ÂèëÈÄÅ</Button>\n            </section>\n        )\n    }\n\n    showFace = e => {\n        e.nativeEvent.stopImmediatePropagation()\n        const {showFace} = this.state\n        this.setState({ showFace: !showFace })\n    }\n\n    // Êé•Êî∂Â≠êÁªÑ‰ª∂‰º†ÂÄº\n    getFaceItem = (object, faceEmjoy) => {\n        let { message } = this.state\n        message += faceEmjoy + \" \"\n        this.setState({ message })\n    }\n\n    sendChatMess = e => {\n        e.preventDefault();\n        const { message } = this.state\n        if(!message) return\n        this.setState({ message: '' })\n\n        // Êé®ÈÄÅsocketÊ∂àÊÅØ\n        const { chat: { chatUserInfo }} = this.props\n        // sendMsg(message, chatUserInfo.id)\n\n        // ËøôÊòØËá™Â∑±ÁöÑÊ∂àÊÅØ\n        let { user: {userInfo, contacts} } = this.props\n        this.props.pushChatMsg({\n            id: userInfo.id,\n            to_id: chatUserInfo.id,\n            avatar: userInfo.avatar,\n            message: message,\n            position: \"right\"\n        })\n\n        const randomText = [\"Â∑•ÂÖ∑‰∫∫‰∏ÄÂè∑‰∏∫ÊÇ®ÊúçÂä°ÔΩû\", `‰Ω†Â•ΩÔºåÊàëÊòØ${chatUserInfo.nickname}ÔºåÂæàÈ´òÂÖ¥ËÆ§ËØÜ‰Ω†`, \"oh godÔºå‰Ω†Áªà‰∫éÊÉ≥Ëµ∑Êàë‰∫ÜÂïä\", \"ÊòéÂ§©‰∏ÄËµ∑ÂéªÁà¨Â±±Èú≤Ëê•ÂïäÔºåÊúâÁ©∫ÂêóÔºü\", \"helloÔºåÊàëÁé∞Âú®Âú®Â∑•‰ΩúÔºå‰Ω†Âë¢Ôºü\", \"üåπüåπ ÊÄé‰πàËØ¥Âë¢ÔºåÈÇ£Â∞±Âú®‰∏ÄËµ∑ÂêßÔΩû\"]\n        const lastMessage = randomText[parseInt(Math.random()*randomText.length)]\n        this.props.recvChatMsg({\n            id: chatUserInfo.id,\n            to_id: userInfo.id,\n            avatar: chatUserInfo.avatar,\n            message: lastMessage,\n            position: \"left\"\n        })\n\n        if(contacts) {\n            const index = contacts.findIndex(user => user.id === chatUserInfo.id)\n            if(index >= 0) {\n                contacts[index].last_mess = lastMessage; contacts[index].time = \"ÂàöÂàö\"\n                if(index > 0) {\n                    contacts.unshift(contacts.splice(index)[0])\n                }\n                this.props.modifyContacts(contacts)\n            }\n        }\n    }\n}\n\nexport default connect(\n    state => ({ chat: state.chat, user: state.user }),\n    { pushChatMsg, recvChatMsg, modifyContacts }\n)(ChatTextarea)"]},"metadata":{},"sourceType":"module"}