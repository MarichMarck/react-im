{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mr.bo/\\u9879\\u76EE/React/react-im\\u7684\\u526F\\u672C/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mr.bo/\\u9879\\u76EE/React/react-im\\u7684\\u526F\\u672C/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";/**\n * 对应 reducers 中的 action 同步/异步请求\n */import Cookies from'js-cookie';import{websocket}from'../utils/websocket';import{initChatData,receiveChatMsg,sendChatMsg,showRightType,showFriendInfo,authSuccess,errMsg,userInfo,logOut,modifyUserContacts,getNewFriends,getMailList}from'./init';import{reqUserInfo}from'../api';import{pySegSort}from'../utils';// 数据模拟\nimport{user,contact}from'../config/initMain';import{mailList}from'../config/mailList';import{newFriend}from'../config/newFriend';// 用户登录\nexport var login=function login(username,password){return(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:Cookies.set('token',username+password);dispatch(authSuccess(\"\\u6B22\\u8FCE\\u4F60\".concat(username)));case 2:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());};// 退出登录\nexport var logout=function logout(){return(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:Cookies.remove('token');dispatch(logOut({}));case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}());};// 界面信息初始化\nexport var initMain=function initMain(token){return(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:dispatch(userInfo({userInfo:user,contacts:contact||[]}));// websocket(user)  // 这里可接入 socket\ncase 1:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}());};// 获取用户信息\nexport var initUserInfo=function initUserInfo(token){return(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var response,result;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return reqUserInfo(token);case 2:response=_context4.sent;result=response.data;if(result.code===200){dispatch(userInfo(result.data));websocket(result.data.userInfo);}else{dispatch(errMsg(result.msg));}case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}());};// 修改消息会话列表\nexport var modifyContacts=function modifyContacts(contacts){return function(dispatch){dispatch(modifyUserContacts({contacts:contacts}));};};// 初始化消息列表\nexport var initChatInfo=function initChatInfo(chatUserInfo){return function(dispatch){dispatch(initChatData({chatUserInfo:chatUserInfo,loading:false,showRightType:'message'}));};};// 切换右侧显示状态\nexport var changeRightType=function changeRightType(type){return function(dispatch){dispatch(showRightType({showRightType:type}));};};// 发送消息\nexport var pushChatMsg=function pushChatMsg(chat){return function(dispatch){dispatch(sendChatMsg(chat));};};// 收到好友消息\nexport var recvChatMsg=function recvChatMsg(chat){return function(dispatch){dispatch(receiveChatMsg(chat));};};// 获取好友基本信息\nexport var getFriendInfo=function getFriendInfo(friend_uid){return(/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return dispatch(changeRightType('userInfo'));case 2:_context5.next=4;return dispatch(showFriendInfo(friend_uid));case 4:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x5){return _ref5.apply(this,arguments);};}());};// 获取好友申请列表\nexport var getNewFriendList=function getNewFriendList(token){return(/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(dispatch){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:dispatch(getNewFriends(newFriend));case 1:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x6){return _ref6.apply(this,arguments);};}());};// 获取用户通讯录列表\nexport var getUserMailList=function getUserMailList(token){return(/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(dispatch){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:dispatch(getMailList(pySegSort(mailList)));case 1:case\"end\":return _context7.stop();}}},_callee7);}));return function(_x7){return _ref7.apply(this,arguments);};}());};","map":{"version":3,"sources":["/Users/mr.bo/项目/React/react-im的副本/src/redux/actions.js"],"names":["Cookies","websocket","initChatData","receiveChatMsg","sendChatMsg","showRightType","showFriendInfo","authSuccess","errMsg","userInfo","logOut","modifyUserContacts","getNewFriends","getMailList","reqUserInfo","pySegSort","user","contact","mailList","newFriend","login","username","password","dispatch","set","logout","remove","initMain","token","contacts","initUserInfo","response","result","data","code","msg","modifyContacts","initChatInfo","chatUserInfo","loading","changeRightType","type","pushChatMsg","chat","recvChatMsg","getFriendInfo","friend_uid","getNewFriendList","getUserMailList"],"mappings":"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","sourcesContent":["/**\n * 对应 reducers 中的 action 同步/异步请求\n */\nimport Cookies from 'js-cookie'\nimport {websocket} from '../utils/websocket'\nimport {\n    initChatData, receiveChatMsg, sendChatMsg, showRightType, showFriendInfo, authSuccess,\n    errMsg, userInfo,logOut, modifyUserContacts, getNewFriends, getMailList\n} from './init'\nimport { reqUserInfo } from '../api'\nimport {pySegSort} from '../utils'\n\n// 数据模拟\nimport {user, contact} from '../config/initMain'\nimport {mailList} from '../config/mailList'\nimport {newFriend} from '../config/newFriend'\n\n// 用户登录\nexport const login = (username, password) => {\n    return async dispatch => {\n        Cookies.set('token', username+password)\n        dispatch(authSuccess(`欢迎你${username}`))\n    }\n}\n\n// 退出登录\nexport const logout = () => {\n    return async dispatch => {\n        Cookies.remove('token'); dispatch(logOut({}))\n    }\n}\n\n// 界面信息初始化\nexport const initMain = token => {\n    return async dispatch => {\n        dispatch(userInfo({userInfo: user, contacts: contact || []}))\n        // websocket(user)  // 这里可接入 socket\n    }\n}\n\n// 获取用户信息\nexport const initUserInfo = token => {\n    return async dispatch => {\n        const response = await reqUserInfo(token)\n        const result = response.data\n        if (result.code === 200) {\n            dispatch(userInfo(result.data))\n            websocket(result.data.userInfo)\n        } else {\n            dispatch(errMsg(result.msg))\n        }\n    }\n}\n\n// 修改消息会话列表\nexport const modifyContacts = contacts => {\n    return dispatch => {\n        dispatch(modifyUserContacts({contacts}))\n    }\n}\n\n// 初始化消息列表\nexport const initChatInfo = chatUserInfo => {\n    return dispatch => {\n        dispatch(initChatData({chatUserInfo, loading: false, showRightType: 'message'}))\n    }\n}\n\n// 切换右侧显示状态\nexport const changeRightType = type => {\n    return dispatch => {\n        dispatch(showRightType({showRightType: type}))\n    }\n}\n\n// 发送消息\nexport const pushChatMsg = chat => {\n    return dispatch => {\n        dispatch(sendChatMsg(chat))\n    }\n}\n\n// 收到好友消息\nexport const recvChatMsg = chat => {\n    return dispatch => {\n        dispatch(receiveChatMsg(chat))\n    }\n}\n\n// 获取好友基本信息\nexport const getFriendInfo = friend_uid => {\n    return async dispatch => {\n        await dispatch(changeRightType('userInfo'))\n        await dispatch(showFriendInfo(friend_uid))\n    }\n}\n\n// 获取好友申请列表\nexport const getNewFriendList = token => {\n    return async dispatch => {\n        dispatch(getNewFriends(newFriend))\n    }\n}\n\n// 获取用户通讯录列表\nexport const getUserMailList = token => {\n    return async dispatch => {\n        dispatch(getMailList(pySegSort(mailList)))\n    }\n}"]},"metadata":{},"sourceType":"module"}